{% extends "base.html" %}
{% block title %}Gifts{% endblock title %}
{% load crispy_forms_tags %}

<!-- for the meta data to base file  -->
{% block meta_head %}

  {{ gift.name }}. {{ gift.description }}

{% endblock meta_head %}


{% block content %}
<div class="w3-row">
	<div class="w3-half w3-grey w3-container">
		<div class="w3-left">
      		<h1 class="w3-text-white">{{ gift.name }}</h1>
      		<img src="{{ gift.image.url }}" class="w3-left" alt="{{ gift.name }}" style="width:100%">
   		</div>
	</div>
	<div class="w3-half">
		<div class="w3-left-align w3-padding-large">
	        <p><strong>Product Id</strong>: {{ gift.pk }} .</p><br>

	        <p><strong>Price</strong>: Rs <span id="gift-price" style="color: red;">{{ gift.price }}</span>/- <i>(including tax)</i></p>
          {% if gift.description %}

          <p><strong>Details</strong>:<br>{{ gift.description }}</p>

          {% endif %}

	        {% if request.user.is_authenticated %}
            <br><p style="color: rgba(27, 43, 135, 0.92);">You can also call us directly (9843496307).</p><br>
	         <a href="javascript:void(0)" onclick="document.getElementById('id01').style.display='block'"><button class="w3-btn w3-black">Order Now</button></a>
	        {% else %}
          <br><p style="color: rgba(27, 43, 135, 0.92);">Please, login to order a product or call us directly (9843496307).</p><br>
	        <a href="{% url 'account_login' %}"><button class="w3-btn w3-red">Log In</button></a>
	        {% endif %}
	    </div>
	</div>
</div>
<br>
<!-- this is the pop up dialogue box -->

<div id="id01" class="w3-modal" style="z-index:4">
  <div class="w3-modal-content w3-animate-zoom w3-padding-large">
    <div class="w3-container w3-padding w3-red">
       <span onclick="document.getElementById('id01').style.display='none'"
       class="w3-button w3-red w3-right w3-xxlarge"><i class="fa fa-remove"></i></span>
      <h2>Order Form</h2>
    </div>
    <div class="w3-panel">
      <b>Price</b> : Rs <span id="result-price" style="color: red; font-weight: bold; font-size: 18;"></span>/- <i>(including tax)</i> <br><br></p>
      <form action='' method="POST">{% csrf_token %}
      {{ order_form|crispy }}
      <div class="w3-section">
        <button class="w3-button w3-red w3-right w3-margin-bottom" type="submit">Submit<i class="fa fa-paper-plane"></i></button> 
      </div> 
      </form>   
    </div>
  </div>
</div>
{% endblock content %}

{% block script %}
$(document).ready(function(){

   // this_ helps in_ showing popups box while_ errors
  if ($(".form-group").hasClass("has-error")){
  $("#id01").show();
  }

  $(".form-group").change(function(){
      var initial_price=document.getElementById("gift-price").innerHTML;
      var sums = initial_price

      $("input[name=quantity]").each(function(){
       sums = parseFloat($(this).val())*sums;
       sums = Math.round(sums);
         })
    document.getElementById("result-price").innerHTML=sums;
    });

  });
{% endblock script %}








